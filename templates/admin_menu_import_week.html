{% from 'macros/admin_menu.html' import render_flash_messages, render_status_banner %}
{% extends "ui/unified_admin_base.html" %}
{% block admin_title %}Meny Vecka {{ vm.week }}/{{ vm.year }}{% endblock %}
{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/admin.css') }}">
{% endblock %}
{% block admin_main %}
    <section class="ua-section">
        <div class="ua-card">
            <h1>Meny för vecka {{ vm.week }}, {{ vm.year }}</h1>
            <p class="admin-intro">Importera och granska veckomeny. Backendfält och texter bibehålls.</p>
        </div>
    </section>

    <section class="ua-section">
        <div class="ua-card">
            {{ render_status_banner(vm.menu_status, vm.year, vm.week, vm.etag, csrf_token_input()) }}
        </div>
    </section>

    <section class="ua-section">
        <div class="ua-card">
            {{ render_flash_messages() }}
        </div>
    </section>

    {% if vm.days %}
        {% for day_name, meals in vm.days.items() %}
            <section class="ua-section">
                <div class="ua-card">
                    <h2>{{ day_name }}</h2>
                    {% if meals %}
                        <table class="admin-table">
                            <thead>
                                <tr>
                                    <th>Måltid</th>
                                    <th>Variant</th>
                                    <th>Rätt</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for meal_name, variants in meals.items() %}
                                    {% for variant_type, info in variants.items() %}
                                        <tr>
                                            <td>{{ meal_name }}</td>
                                            <td>{{ variant_type }}</td>
                                            <td>{{ info.dish_name or '—' }}</td>
                                        </tr>
                                    {% endfor %}
                                {% endfor %}
                            </tbody>
                        </table>
                    {% else %}
                        <p style="color: #666; font-style: italic;">Ingen menydata för denna dag.</p>
                    {% endif %}
                </div>
            </section>
        {% endfor %}
    {% else %}
        <section class="ua-section">
            <div class="ua-card">
                <p style="color: #666; font-style: italic;">Ingen menydata tillgänglig för denna vecka.</p>
            </div>
        </section>
    {% endif %}
{% endblock %}
