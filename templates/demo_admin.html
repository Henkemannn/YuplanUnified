<!doctype html>
<html lang="sv">
  <head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>Demo – Admin flows</title>
    <link rel="stylesheet" href="/static/demo.css"/>
  </head>
  <body data-demo-ui="{% if demo_ui_enabled %}1{% else %}0{% endif %}">
    <header class="demo-header">
      <div class="logo">
        <!-- Yuplan logga (alla loggor finns i /static/logo/) -->
        <img id="ylogo" src="/static/logo/yuplan_logo.svg" alt="Yuplan" width="28" height="28"/>
        <div id="ymark" aria-hidden="true">Y</div>
        <span>Yuplan Demo</span>
      </div>
      {% if staging_demo %}
        <div class="banner">Staging simple auth is enabled. Use the button below to log in as admin.</div>
      {% endif %}
    </header>

    <nav class="demo-tabs" role="tablist" aria-label="Yuplan demo tabs">
      <button id="tab-weekview" class="tab tab--active" role="tab" aria-selected="true" tabindex="0" aria-controls="panel-weekview" data-tab="weekview">Weekview</button>
      <button id="tab-admin" class="tab" role="tab" aria-selected="false" tabindex="-1" aria-controls="panel-admin" data-tab="admin">Admin</button>
      <button id="tab-alt2" class="tab" role="tab" aria-selected="false" tabindex="-1" aria-controls="panel-alt2" data-tab="alt2">Menyval</button>
      <button id="tab-report" class="tab" role="tab" aria-selected="false" tabindex="-1" aria-controls="panel-report" data-tab="report">Report</button>
    </nav>

    <section id="panel-weekview" class="panel panel--active" role="tabpanel" aria-labelledby="tab-weekview" data-panel="weekview">
      <div class="card">
        <h3>Weekview</h3>
        <p class="muted">Placeholder for weekview demo.</p>
      </div>
    </section>

    <section id="panel-admin" class="panel" role="tabpanel" aria-labelledby="tab-admin" data-panel="admin" hidden>
      <div class="card">
        <h3>1) Login (simple)</h3>
        <p class="muted">Sends POST /auth/login {role:"admin"}. Required for cookies and CSRF token.</p>
        <button id="btnLogin">Login as admin</button>
        <span id="loginStatus"></span>
      </div>

      <div class="row">
        <div class="card">
          <h3>2) Departments (ETag and If-None-Match)</h3>
          <label>Site ID <input id="siteId" type="text" placeholder="enter site_id" /></label>
          <div>
            <button id="btnLoadDepts">Load departments</button>
            <button id="btnDepts304">Conditional GET (If-None-Match)</button>
          </div>
          <div class="muted">Collection ETag: <span id="deptsEtag" class="et">—</span></div>
          <div id="depts"></div>
          <div style="margin-top:.5rem">
            <label>Rename first department to <input id="deptNewName" type="text" placeholder="New name"/></label>
            <button id="btnRename">PUT with If-Match</button>
            <span id="renameStatus"></span>
          </div>
        </div>
      </div>
    </section>

    <section id="panel-alt2" class="panel" role="tabpanel" aria-labelledby="tab-alt2" data-panel="alt2" hidden>
      <div class="card">
        <h3>3) Menyval (idempotent PUT + toggle)</h3>
        <label>Week <input id="week" type="number" value="51" min="1" max="53"/></label>
        <div>
          <button id="btnLoadAlt2">Load Alt2</button>
          <button id="btnAlt2304">Conditional GET (If-None-Match)</button>
        </div>
        <div class="muted">Collection ETag: <span id="alt2Etag" class="et">—</span></div>
        <div id="alt2"></div>
        <div style="margin-top:.5rem">
          <button id="btnAlt2Idem">PUT idempotent (no change)</button>
          <button id="btnAlt2Toggle">Toggle first item</button>
          <span id="alt2Status"></span>
        </div>
      </div>
    </section>

    <section id="panel-report" class="panel" role="tabpanel" aria-labelledby="tab-report" data-panel="report" hidden>
      <header class="panel-hdr">
        <h2>Rapport</h2>
        <div class="inline-controls">
          <label for="reportWeek">Vecka</label>
          <input id="reportWeek" type="number" min="1" max="53" />
          <button id="btnLoadReport" class="btn">Läs in</button>
          <button id="btnExportCsv" class="btn" aria-label="Exportera CSV">Export CSV</button>
        </div>
      </header>
      <div id="reportSummary" class="report-cards"></div>
    </section>

    <script src="/static/demo.js"></script>
  </body>
</html>
