[mypy]
python_version = 3.11
ignore_missing_imports = True
warn_unused_ignores = True
strict_optional = True
follow_imports = skip
show_error_codes = True
pretty = True

# Exclude tests/legacy/modules from analysis
exclude = ^(tests/|legacy/|modules/|scripts/)

# === Strict pockets kept for RC1 ===
[mypy-core.http_errors]
disallow_untyped_defs = True

[mypy-core.errors]
disallow_untyped_defs = True
disable_error_code = misc, unused-ignore

[mypy-core.rate_limit]
disallow_untyped_defs = True
[mypy-core.audit]
strict = True
[mypy-core.db]
strict = True

# Strict pocket 2 (service layer)
[mypy-core.portion_recommendation_service]
strict = True
[mypy-core.menu_service]
strict = True
[mypy-core.service_metrics_service]
strict = True

# Strict pocket 3 (auth & feature flags)
[mypy-core.auth]
strict = True
[mypy-core.feature_flags]
strict = True

# Strict pocket 4 (concurrency control)
[mypy-core.concurrency]
strict = True

[mypy-core.importers.*]
strict = True
[mypy-core.importers.docx_importer]
ignore_errors = True  # legacy menu importer; exclude from Pocket 8 strict scope
[mypy-core.pagination]
strict = True

[mypy-core.deprecation]
strict = True

[mypy-core.limit_registry]
disallow_untyped_defs = True

[mypy-core.csrf]
disallow_untyped_defs = True

[mypy-core.app_factory]
disallow_untyped_defs = True
# Decorators and runtime dict-shaping generate noisy errors; suppress for RC1
disable_error_code = misc, no-untyped-call, no-untyped-def, unused-ignore, index, dict-item, attr-defined

[mypy-core.audit_events]
disallow_untyped_defs = True

[mypy-core.audit_repo]
disallow_untyped_defs = True

# === Temporary shielding (RC1) â€” endpoints and noisy modules ===
[mypy-core.admin_demo_ui]
ignore_errors = True
[mypy-core.openapi_merge]
ignore_errors = True
[mypy-core.weekview.*]
ignore_errors = True
[mypy-core.weekview_api]
ignore_errors = True
[mypy-core.report.*]
ignore_errors = True
[mypy-core.admin_service]
ignore_errors = True
[mypy-core.menu_choice_api]
disable_error_code = unused-ignore
[mypy-core.auth]
ignore_errors = True
[mypy-core.diet_api]
ignore_errors = True
[mypy-core.import_api]
ignore_errors = True
[mypy-core.tasks_api]
ignore_errors = True
[mypy-core.notes_api]
ignore_errors = True
[mypy-core.menu_api]
ignore_errors = True
[mypy-core.admin_api]
ignore_errors = True
[mypy-core.admin_audit_api]
ignore_errors = True
[mypy-core.turnus_api]
ignore_errors = True
[mypy-core.service_metrics_api]
ignore_errors = True
[mypy-core.service_recommendation_api]
ignore_errors = True
[mypy-core.portion_recommendation_api]
ignore_errors = True
[mypy-core.attendance_api]
ignore_errors = True
[mypy-core.export_api]
ignore_errors = True
[mypy-core.ui_blueprint]
ignore_errors = True
[mypy-core.demo_views]
ignore_errors = True
[mypy-core.legacy_kommun_ui]
ignore_errors = True
[mypy-core.legacy_offshore_ui]
[mypy-core.menu_import_service]
ignore_errors = True
[mypy-core.openapi_ui]
ignore_errors = True
[mypy-core.inline_ui]
ignore_errors = True
[mypy-core.app_errors]
ignore_errors = True
[mypy-core.app_sessions]
ignore_errors = True
[mypy-core.services]
ignore_errors = True
[mypy-core.models]
ignore_errors = True
[mypy-core.jwt_utils]
ignore_errors = True
[mypy-core.pagination]
ignore_errors = True
[mypy-core.telemetry]
ignore_errors = True
[mypy-core.rate_limiter]
ignore_errors = True
[mypy-core.rate_limiter_memory]
ignore_errors = True
[mypy-core.rate_limiter_token_bucket_redis]
ignore_errors = True
[mypy-core.rate_limiter_redis]
ignore_errors = True
[mypy-core.rate_limiter_noop]
ignore_errors = True
[mypy-core.importers.*]
ignore_errors = True
[mypy-core.superuser_impersonation_api]
ignore_errors = True
[mypy-core.support]
ignore_errors = True
[mypy-core.impersonation]
ignore_errors = True
[mypy-core.menu_service]
ignore_errors = True
[mypy-core.diet_service]
ignore_errors = True
[mypy-core.attendance_service]
ignore_errors = True
[mypy-core.menu_import_service]
ignore_errors = True
[mypy-core.feature_service]
ignore_errors = True
[mypy-core.portion_recommendation_service]
ignore_errors = True
[mypy-core.logging_setup]
ignore_errors = True
[mypy-core.app_authz]
ignore_errors = True
[mypy-core.roles]
ignore_errors = True
[mypy-core.http_limits]
ignore_errors = True
[mypy-core.tasks_service]
ignore_errors = True

# Silence type checking on alembic migration scripts
[mypy-migrations.*]
disable_error_code = attr-defined

# Exclude legacy path modules entirely (safety)
[mypy-legacy.*]
ignore_errors = True
