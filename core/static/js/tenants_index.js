function escapeHtml(s){return String(s||'').replace(/[&<>"']/g,c=>({"&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&#39;"}[c]));}
async function loadTenants(q=""){ try { const r=await fetch('/api/superuser/tenants'+(q?`?query=${encodeURIComponent(q)}`:''), { credentials:'same-origin' }); const d=await r.json().catch(()=>({items:[]})); const ul=document.getElementById('tenants-list'); if(!ul) return; ul.innerHTML=''; (d.items||[]).forEach(t=>{ const li=document.createElement('li'); li.innerHTML=`<a data-testid="tenant-link" class="yu-no-underline" href="/tenants/${encodeURIComponent(t.id)}">${escapeHtml(t.name)} ${t.slug?`<span class=\"chip\">${escapeHtml(t.slug)}</span>`:''} ${t.enabled?'' : '<span class=\"badge\">inaktiv</span>'}`; ul.appendChild(li);}); } catch(_){} }
document.addEventListener('DOMContentLoaded',()=>{ loadTenants(); const f=document.getElementById('t-search'); if(f) f.addEventListener('submit',e=>{e.preventDefault(); const fd=new FormData(e.target); const q=(fd.get('q')||'').toString(); loadTenants(q);});});