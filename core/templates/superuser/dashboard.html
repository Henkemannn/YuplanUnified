{% extends "ui/base.html" %}
{% block title %}Superuser â€“ Ã–versikt{% endblock %}

{% block head_extra %}
  <link rel="preload" href="{{ url_for('ui.static', filename='ui/tokens.css') }}" as="style" crossorigin>
{% endblock %}

{% block content %}
<div class="su-shell" role="application">
  <nav class="su-nav" aria-label="Huvudmeny">
    <ul class="su-nav__list" role="list">
      <li><a id="nav-overview" data-testid="nav-overview" href="{{ url_for('ui.superuser_dashboard') }}" aria-current="page" class="su-nav__link su-nav__link--active">Ã–versikt</a></li>
  <li><a id="nav-tenants" data-testid="nav-tenants" href="/tenants" class="su-nav__link" tabindex="0">Tenants</a></li>
      <li><a id="nav-modules" data-testid="nav-modules" href="#" class="su-nav__link" tabindex="0">Moduler</a></li>
  <li><a id="nav-flags" data-testid="nav-flags" href="/feature-flags" class="su-nav__link" tabindex="0">Feature Flags</a></li>
      <li><a id="nav-audit" data-testid="nav-audit" href="#" class="su-nav__link" tabindex="0">Audit</a></li>
    </ul>
  </nav>

  <main class="su-main" id="main" tabindex="-1">
    <h1 id="page-title">Superuser â€“ Ã–versikt</h1>

    <section aria-labelledby="kpi-title" class="kpi">
      <h2 id="kpi-title" class="visually-hidden">Nyckeltal</h2>
      <div class="kpi-grid">
        <article id="kpi-tenants" class="card kpi-card" data-testid="kpi-tenants" aria-busy="true">
          <div class="kpi-icon" aria-hidden="true">ğŸ¢</div>
          <div class="kpi-meta">
            <div class="kpi-label">Tenants</div>
            <div class="kpi-value" data-kpi-value>â€”</div>
          </div>
        </article>
        <article id="kpi-modules" class="card kpi-card" data-testid="kpi-modules" aria-busy="true">
          <div class="kpi-icon" aria-hidden="true">ğŸ§©</div>
          <div class="kpi-meta">
            <div class="kpi-label">Aktiva moduler</div>
            <div class="kpi-value" data-kpi-value>â€”</div>
          </div>
        </article>
        <article id="kpi-flags" class="card kpi-card" data-testid="kpi-flags" aria-busy="true">
          <div class="kpi-icon" aria-hidden="true">ğŸš©</div>
          <div class="kpi-meta">
            <div class="kpi-label">Feature flags (pÃ¥)</div>
            <div class="kpi-value" data-kpi-value>â€”</div>
          </div>
        </article>
      </div>
    </section>

    <section aria-labelledby="qa-title" class="qa">
      <h2 id="qa-title" class="visually-hidden">SnabbÃ¥tgÃ¤rder</h2>
      <div class="yu-row yu-gap-3 su-actions">
        <a class="yu-btn yu-btn--solid" data-testid="qa-create-tenant" id="qa-create-tenant" aria-label="Skapa tenant" href="#create-tenant">Skapa tenant</a>
        <a class="yu-btn yu-btn--outline" data-testid="qa-open-flags" aria-label="Visa Feature Flags" href="/feature-flags">Visa Flags</a>
        <a class="yu-btn yu-btn--soft" data-testid="qa-open-audit" aria-label="Ã–ppna Audit" href="/audit">Ã–ppna Audit</a>
      </div>
    </section>

    <!-- Modal: Skapa tenant -->
    <div id="tenant-modal" class="yu-modal" role="dialog" aria-modal="true" aria-labelledby="tenant-modal-title" hidden>
      <div class="yu-modal__panel">
        <h3 id="tenant-modal-title">Skapa tenant</h3>
        <div class="alert-error" id="tenant-error" role="alert" hidden></div>
        <form id="tenant-form">
          <label>Namn <input id="t-name" name="name" required></label>
          <label>Slug <input id="t-slug" name="slug" aria-describedby="slug-help"><span id="slug-help" class="yu-help">Kan Ã¤ndras</span></label>
          <label>Tema <select id="t-theme" name="theme"><option>ocean</option><option>emerald</option></select></label>
          <label class="yu-row yu-gap-2"><input id="t-enabled" name="enabled" type="checkbox" checked> Aktiv</label>
          <div class="yu-row yu-gap-2 yu-right"><button type="button" id="t-cancel" class="yu-btn yu-btn--soft">Avbryt</button><button type="submit" id="t-submit" class="yu-btn yu-btn--solid">Skapa</button></div>
        </form>
      </div>
    </div>

    <section aria-labelledby="events-title" class="events">
      <h2 id="events-title">Senaste hÃ¤ndelser</h2>
      <ul id="events-list" class="event-list" data-testid="events-list" aria-labelledby="events-title"></ul>
      <div id="events-empty" class="card events-empty" data-testid="events-empty" hidden>
        <div class="events-empty__icon" aria-hidden="true">ï¿½</div>
        <p class="events-empty__text">Inga hÃ¤ndelser Ã¤nnu. NÃ¤r systemet anvÃ¤nds visas aktiviteter hÃ¤r.</p>
        <a class="yu-btn yu-btn--soft" href="/audit">GÃ¥ till Audit</a>
      </div>
    </section>

    <section aria-labelledby="health-title" class="health">
      <h2 id="health-title">SystemhÃ¤lsa</h2>
      <div class="card health-grid" data-testid="sys-health">
        <span class="badge" id="health-api" data-testid="health-api">API: â€”</span>
        <span class="badge" id="health-db" data-testid="health-db">DB: â€”</span>
        <span class="badge" id="health-queue" data-testid="health-queue">Queue: â€”</span>
      </div>
    </section>

    {% if dev %}
    <section aria-labelledby="dev-title" class="dev" data-testid="dev-theme-preview">
      <h2 id="dev-title">Dev: Theme Preview</h2>
      <div class="yu-row yu-gap-3">
        <div role="group" aria-label="Mode">
          <button class="yu-btn yu-btn--soft" id="dev-mode-light" aria-pressed="false">Light</button>
          <button class="yu-btn yu-btn--soft" id="dev-mode-dark" aria-pressed="true">Dark</button>
        </div>
      </div>
      <p class="yu-help">FÃ¶rhandsvisa Light/Dark. Val sparas i localStorage och uppdaterar <code>data-mode</code>.</p>
    </section>
    {% endif %}
  </main>
</div>
{% endblock %}

{% block scripts %}
  <script src="{{ url_for('ui.static', filename='js/dashboard.js') }}" defer></script>
{% endblock %}
